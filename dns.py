from scapy.all import *
import time

# Set the path to the executable file
# Example with raw string literal
exe_path = r"C:\Program Files (x86)\Illustrator\x64\Support Files\Contents\Windows\Illustrator.exe"

# Set the duration of the capture window in seconds
window_duration = 10

# Set the DNS filter to capture only DNS packets
dns_filter = "udp port 53"

# Start the capture
packets = sniff(timeout=window_duration, filter=dns_filter)

# Run the executable file and capture the network traffic generated by it
process = subprocess.Popen([exe_path])
time.sleep(window_duration)
process.kill()

# Filter the captured packets for DNS requests and count them
dns_packets = [pkt for pkt in packets if DNS in pkt]
dns_request_count = len(dns_packets)

# Print the number of DNS requests made by the executable in the capture window
print(f"The executable made {dns_request_count} DNS requests in {window_duration} seconds.")
